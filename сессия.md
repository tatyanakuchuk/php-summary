# Сессии

_Способ хранения данных о сеансе пользователя на стороне сервера_

1. [Что такое сессии?](#1)
2. [Как работают сессии?](#2)
3. [Сессионный cookie](#3)
4. [Где хранятся сессии?](#4)
5. [Сколько существует сессия?](#5)
6. [Сравнение сессий и cookies?](#6)
7. [Где использовать куки и сессии?](#7)
8. [Практика работы с сессиями](#8)
9. [Как удалить сессию?](#9)

<a name="1"><h2>Что такое сессии?</h2></a>

**Сессии** – это не стандарт и не часть HTTP протокола как cookies, а  понятие из языка PHP, надстройка над обычными cookies.  

**Преимущества:**
- абстракция над cookies
- могут хранить любые объемы и типы данных

**Особенности:**
- живут только внутри одного сеанса
- хранят данные в файлах (по умолчанию)
- требуют для своей работы cookies

<a name="2"><h2>Как работают сессии?</h2></a>

1. PHP генерирует случайный идентификатор сессии на основе данных пользователя
2. PHP создает специальный файл с этим именем, где будет хранить данные сессии 
3. PHP создает специальную куку с именем PHPSESSID, куда записывает идентификатор сессии
4. При следующих запросах проверяется эта кука, и по значению из неё запрашивается информация из файла

<a name="3"><h2>Сессионный cookie</h2></a>

Сессионная кука – как номерок в гардеробе:   не содержит предмет, но позволяет его получить.

![В браузере:](../master/img/Screenshot_2.png)

<a name="4"><h2>Где хранятся сессии?</h2></a>

_Сессии хранятся в виде файлов в файловой системе сервера._

Один файл - одна сессия конкретного пользователя.

```
root@localhost:/var/lib/php/sessions# ls –la  
-rw------- 1 0   Apr 28 14:22 sess_03otfci957os118v6eppfeuvc4  
-rw------- 1 0   Apr 28 14:16 sess_8nfdaan5ueecme63bfhuet0f06  
-rw------- 1 967 Apr 28 14:43 sess_95vttihdopv5u1kj1cd66eqfu3  
-rw------- 1 967 Apr 28 14:44 sess_h88moinp3qpk8tdve2embccps3  
```

<a name="5"><h2>Сколько существует сессия?</h2></a>

- Время жизни сессии – 24 минуты
- Сессия уничтожается при закрытии браузера 

Увеличение времени жизни сессии:

```php
ini_set('session.cookie_lifetime', 86400); 
ini_set('session.gc_maxlifetime', 86400);
```

<a name="6"><h2>Сравнение сессий и cookies</h2></a>

![таблица](../master/img/Screenshot_3.png)

<a name="7"><h2>Где использовать куки и сессии?</h2></a>

**Cookie:**
- хранение настроек сайта
- отслеживание посещаемости
- хранение небольших объемов   данных

**Сессии:**
- сохранять ключ капчи
- хранение данных пользователя
- хранение любых данных  в рамках сеанса

<a name="8"><h2>Практика работы с сессиями</h2></a>

```php
<?php 
session_start();  // обязательно при использовании сессий

 if (isset($_SESSION['username'])) {  
	print($_SESSION['username']);  // чтение значения из сессии
} 
$_SESSION['username'] = "Вася"; // запись значения в сессию
```

<a name="9"><h2>Как удалить сессию?</h2></a>

Чтобы удалить все данные и закрыть сессию, просто   обнулите массив $_SESSION.   

При окончании работы скрипта PHP автоматически   удалит все данные сессии на сервере.

```php
$_SESSION = [];
```


